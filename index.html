<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="YuChen Chai">
<!--  高德地图API-->
  <script src="https://a.amap.com/jsapi_demos/static/demo-center/js/demoutils.js"></script>
  <script type="text/javascript" src="https://webapi.amap.com/maps?v=1.4.14&key=2ef52157e7e81867dbc9c4b1b0b84e92&plugin=AMap.Driving,AMap.Transfer,AMap.Riding,AMap.Walking"></script>

  <title>欢迎来到郑东新区实验——一个MIT的城市实验</title>

  <!-- Bootstrap core CSS -->
  <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">


  <!-- Custom styles for this template -->
  <link href="css/modern-business.css" rel="stylesheet">
  <link href="css/own-style.css" rel="stylesheet">

</head>

<body>

  <!-- Navigation -->
  <nav class="navbar fixed-top navbar-expand-lg navbar-dark bg-dark fixed-top">
    <div class="container">
      <img src="resource/MIT_Logo.jpg" height="30px" style="padding-right: 5px">
      <a class="navbar-brand" href="index.html">郑东新区实验</a>
      <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarResponsive">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item">
            <a class="nav-link" href="about.html">关于实验</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="contact.html">团队成员</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="contact.html">联系我们</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <header>
    <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
      <ol class="carousel-indicators">
        <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
        <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
        <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
      </ol>
      <div class="carousel-inner" role="listbox">
        <!-- Slide One - Set the background image for this slide in the line below -->
        <div class="carousel-item active" style="background-image: url('./resource/Display-Slide-1.jpg')">
          <div class="carousel-caption d-none d-md-block">
            <h3>First Slide</h3>
            <p>This is a description for the first slide.</p>
          </div>
        </div>
<!--         Slide Two - Set the background image for this slide in the line below -->
        <div class="carousel-item" style="background-image: url('./resource/Display-Slide-2.jpg')">
          <div class="carousel-caption d-none d-md-block">
            <h3>Second Slide</h3>
            <p>This is a description for the second slide.</p>
          </div>
        </div>
        <!-- Slide Three - Set the background image for this slide in the line below -->
        <div class="carousel-item" style="background-image: url('./resource/Display-Slide-3.jpg')">
          <div class="carousel-caption d-none d-md-block">
            <h3>Third Slide</h3>
            <p>This is a description for the third slide.</p>
          </div>
        </div>
      </div>
      <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="sr-only">Previous</span>
      </a>
      <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="sr-only">Next</span>
      </a>
    </div>
  </header>

  <!-- Page Content -->

  <div class="container">
    <h1 class="my-2">欢迎参与郑东新区实验！</h1>
    <h5 class="my-2">我们将根据你的起始位置和终点位置，为你提供各种可行方案以供参考</h5>
    <br>
    <div style="width:520px;height:34px;">
      <input id="Start" type="text" placeholder="起点"  style="height:25px"/>
      <input id="End" type="text" placeholder="终点"  style="height:25px"/>
      <input type="button" id="result" value="查询"/>
<!--      <a class="mButton" href="#">查询</a> -->
    </div>
    <br>

    <table id=mtable border="solid" width="100%" height="15px" cellspacing="0" cellpadding="5">
      <thead>

      <tr align="center" valign="center" bgcolor=#fefefe>
        <th></th>
        <th colspan="2">机动车</th>
        <th></th>
        <th colspan="3">公共交通</th>
        <th></th>
        <th colspan="2">骑行/走路</th>
      </tr>
      <tr align="center" valign="center" bgcolor=#fefefe>
        <th></th>
        <th>自驾车</th>
        <th>出租车</th>
        <th></th>
        <th>公交车</th>
        <th>地铁</th>
        <th>步行</th>
        <th></th>
        <th>骑行</th>
        <th>步行</th>
      </tr>
      </thead>

      <tr align="center" valign="center" bgcolor=#fefefe>
        <th>时间(分钟)</th>
        <td></td>
        <td></td>
        <td></td>
        <td colspan="3"></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      <tr align="center" valign="center" bgcolor=#fefefe>
        <th>距离(公里)</th>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      <tr align="center" valign="center" bgcolor=#fefefe>
        <th>成本(元)</th>
        <td></td>
        <td></td>
        <td></td>
        <td colspan="3"></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>

    </table>

    <br>
    <div>
      <div class="mGrid" style="display:inline-block">
        <h5 class="my-text">自驾车及出租车路径规划</h5>
      </div>
      <div id="map-1">
         <div id="panel1" ></div>
       </div>
    </div>

    <br>

    <div>
      <div class="mGrid" style="display:inline-block">
        <h5 class="my-text">公交车及地铁路径规划</h5>
      </div>
      <div id="map-2">
        <div id="panel2" ></div>
      </div>
    </div>

    <br>

    <div>
      <div class="mGrid" style="display:inline-block">
        <h5 class="my-text">骑行路径规划</h5>
      </div>
      <div id="map-4">
        <div id="panel4" ></div>
      </div>
    </div>

    <br>

    <div>
      <div class="mGrid" style="display:inline-block">
        <h5 class="my-text">步行路径规划</h5>
      </div>
      <div id="map-5">
        <div id="panel5" ></div>
      </div>
    </div>
  </div>

  <br>
  <!-- /.container -->

  <!-- Footer -->
  <footer class="py-5 bg-dark">
    <div class="container">
      <p class="m-0 text-center text-white">Copyright &copy; YuChen Chai 2019</p>
    </div>
    <!-- /.container -->
  </footer>

  <!-- Bootstrap core JavaScript -->
  <script src="vendor/jquery/jquery.min.js"></script>
  <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

</body>

</html>



<script>
  var mcity="郑州";
  var center_x=113.657413;
  var center_y=34.867203;
  $("#result").click(function(){
  var start = $("#Start").val();
  var end = $("#End").val();
  });
</script>
<script type="text/javascript">
TaxiPrice=function(dis,time){
  if(dis<=2)
    return 8;
  else if(dis<=12)
    return (8+(dis-2)*1.5).toFixed(1);
  else
    // console.log((8+15+(dis-12)*2.25).toFixed(1))
    return (8+15+(dis-12)*2.25).toFixed(1);
}
</script>

<script type="text/javascript">
  //基本地图加载
  var map1 = new AMap.Map("map-1", {
    resizeEnable: true,
    center: [center_x, center_y],//地图中心点
    zoom: 13 //地图显示的缩放级别
  });
  //构造路线导航类
  var driving = new AMap.Driving({
    map: map1,
    panel: "panel1"
  });
  console.log(driving)
  $("#result").click(function(){

    var start = $("#Start").val();
    var end = $("#End").val();
    // 根据起终点名称规划驾车导航路线
    driving.search([
      {keyword: start,city:mcity,extensions:"all"},
      {keyword: end,city:mcity,extensions:"all"},

    ], function(status, result) {
      // result 即是对应的驾车导航信息，相关数据结构文档请参考  https://lbs.amap.com/api/javascript-api/reference/route-search#m_DrivingResult
      if (status === 'complete') {
        // console.log(result);
        var tb=document.getElementById("mtable");
        var t=Math.round(result.routes[0].time/60);
        var dist=(result.routes[0].distance/1000).toFixed(1);

        var td=tb.rows[2].cells[1];
        td.innerHTML=t;
        var td=tb.rows[3].cells[1];
        td.innerHTML=dist;

        var td=tb.rows[2].cells[2];
        td.innerHTML=t;
        var td=tb.rows[3].cells[2];
        td.innerHTML=dist;


        log.success('绘制驾车路线完成')
      } else {
        log.error('获取驾车数据失败：' + result)
      }
    });
  });
</script>

<script type="text/javascript">
  var map2 = new AMap.Map("map-2", {
    resizeEnable: true,
    center: [center_x, center_y],//地图中心点
    zoom: 13
  });
  var transOptions = {
    map: map2,
    city: mcity,
    panel: 'panel2',
    policy: AMap.TransferPolicy.LEAST_TIME //乘车策略
  };
  //构造公交换乘类
  var transfer = new AMap.Transfer(transOptions);
  console.log(transfer)

  $("#result").click(function(){
    var start = $("#Start").val();
    var end = $("#End").val();
    transfer.leaveAt("8:00","8:00");
    //根据起、终点名称查询公交换乘路线
    transfer.search([
      {keyword: start,city:mcity},
      //第一个元素city缺省时取transOptions的city属性
      {keyword: end,city:mcity}
      //第二个元素city缺省时取transOptions的cityd属性
    ], function(status, result) {

      // result即是对应的公交路线数据信息，相关数据结构文档请参考  https://lbs.amap.com/api/javascript-api/reference/route-search#m_TransferResult
      if (status === 'complete') {
        console.log(result);
        // console.log(result);
        var tb=document.getElementById("mtable");
        var t=Math.round(result.plans[0].time/60);
        var bus_dist=(result.plans[0].transit_distance/1000).toFixed(1);
        var railway_dist=(result.plans[0].railway_distance/1000).toFixed(1);
        var walk_dist=(result.plans[0].walking_distance/1000).toFixed(1);
        var c=Math.round(result.plans[0].cost);

        var td=tb.rows[2].cells[4];
        td.innerHTML=t;

        var td=tb.rows[3].cells[4];
        td.innerHTML=bus_dist;
        var td=tb.rows[3].cells[5];
        td.innerHTML=railway_dist;
        var td=tb.rows[3].cells[6];
        td.innerHTML=walk_dist;

        var td=tb.rows[4].cells[4];
        td.innerHTML=c;

        var td=tb.rows[4].cells[2];
        td.innerHTML=result.taxi_cost;
        log.success('绘制公交路线完成')
      } else {
        log.error('公交路线数据查询失败' + result)
      }
    });
  });

</script>

<script type="text/javascript">
  var map = new AMap.Map("map-4", {
    resizeEnable: true,
    center: [center_x,center_y],//地图中心点
    zoom: 13 //地图显示的缩放级别
  });
  //步行导航
  var riding = new AMap.Riding({
    map: map,
    panel: "panel4"
  });

  $("#result").click(function(){
    var start = $("#Start").val();
    var end = $("#End").val();
    riding.search([
      {keyword:start,city:mcity},
      {keyword: end,city:mcity}
    ], function(status,result) {
      // result即是对应的骑行路线数据信息，相关数据结构文档请参考  https://lbs.amap.com/api/javascript-api/reference/route-search#m_RidingResult
      if (status === 'complete') {
        // console.log(result);
        var tb=document.getElementById("mtable");
        var t=Math.round(result.routes[0].time/60);
        var dist=(result.routes[0].distance/1000).toFixed(1);

        var td=tb.rows[2].cells[6];
        td.innerHTML=t;
        var td=tb.rows[3].cells[8];
        td.innerHTML=dist;
        log.success('绘制骑行路线完成')
      } else {
        log.error('骑行路线数据查询失败' + result)
      }
    });
  });
</script>

<script type="text/javascript">
  var map = new AMap.Map("map-5", {
    resizeEnable: true,
    center: [center_x, center_y],//地图中心点
    zoom: 13 //地图显示的缩放级别
  });
  //步行导航
  var walking = new AMap.Walking({
    map: map,
    panel: "panel5"
  });
  $("#result").click(function(){
    var start = $("#Start").val();
    var end = $("#End").val();
    walking.search([
      {keyword: start,city:mcity},
      {keyword: end,city:mcity}
    ], function(status, result) {
      // result即是对应的步行路线数据信息，相关数据结构文档请参考  https://lbs.amap.com/api/javascript-api/reference/route-search#m_WalkingResult
      if (status === 'complete') {
        // console.log(result);
        var tb=document.getElementById("mtable");
        var t=Math.round(result.routes[0].time/60);
        var dist=(result.routes[0].distance/1000).toFixed(1);

        var td=tb.rows[2].cells[7];
        td.innerHTML=t;
        var td=tb.rows[3].cells[9];
        td.innerHTML=dist;

        log.success('绘制步行路线完成')
      } else {
        log.error('步行路线数据查询失败' + result)
      }
    });
  });

</script>